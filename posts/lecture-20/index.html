<!DOCTYPE html>
<html lang="en"><head>
    <link rel="apple-touch-icon" sizes="180x180" href="https://xichenlab.com/BIO210-BioStats/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://xichenlab.com/BIO210-BioStats/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://xichenlab.com/BIO210-BioStats/favicon-16x16.png">
    <link rel="manifest" href="https://xichenlab.com/BIO210-BioStats/site.webmanifest">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #FF4D4D;
        }
    </style>

    
    
    
    
    
    

    
    <title>Lecture 20 Confidence Interval For The Variance</title>
    <meta name="description" content="by School of Life Sciences at SUSTech">
    <meta name="keywords" content='blog, gokarna, hugo, data science, biology, genomics'>

    <meta property="og:url" content="https://xichenlab.com/BIO210-BioStats/posts/lecture-20/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Lecture 20 Confidence Interval For The Variance">
    <meta property="og:description" content="by School of Life Sciences at SUSTech">
    <meta property="og:image" content="/images/avatar.jpg">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Lecture 20 Confidence Interval For The Variance">
    <meta name="twitter:description" content="by School of Life Sciences at SUSTech">
    <meta property="twitter:domain" content="https://xichenlab.com/BIO210-BioStats/posts/lecture-20/">
    <meta property="twitter:url" content="https://xichenlab.com/BIO210-BioStats/posts/lecture-20/">
    <meta name="twitter:image" content="/images/avatar.jpg">

    
    <link rel="canonical" href="https://xichenlab.com/BIO210-BioStats/posts/lecture-20/" />

    <link rel="stylesheet" type="text/css" href="https://xichenlab.com/BIO210-BioStats/css/normalize.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" type="text/css" href="https://xichenlab.com/BIO210-BioStats/css/main.css">
    <link disabled id="dark-theme" rel="stylesheet" href="https://xichenlab.com/BIO210-BioStats/css/dark.css">

    <script src="https://xichenlab.com/BIO210-BioStats/js/svg-injector.min.js"></script>
    <script src="https://xichenlab.com/BIO210-BioStats/js/feather-icons.min.js"></script>
    <script src="https://xichenlab.com/BIO210-BioStats/js/main.js"></script>

    
    
        <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.css" integrity="sha384-6LkG2wmY8FK9E0vU9OOr8UvLwsaqUg9SETfpq4uTCN1agNe8HRdE9ABlk+fVx6gZ" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.js" integrity="sha384-31El76TwmbHj4rF9DyLsygbq6xoIobG0W+jqXim+a3dU9W53tdH3A/ngRPxOzzaB" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "$", right: "$", display: false}
                ]
            });
        });
    </script>
  
    
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        
        <div class="avatar">
            <a href="https://xichenlab.com/BIO210-BioStats/">
                <img src="https://xichenlab.com/BIO210-BioStats//images/avatar.jpg" alt="avatar" />
            </a>
        </div>
        

        <div class="nav-title">
            <a class="nav-brand" href="https://xichenlab.com/BIO210-BioStats/">SUSTech BIO210 Biostatistics</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="https://xichenlab.com/BIO210-BioStats"><span data-feather='home'></span> Home </a>
            </div>
            
            <div class="nav-link">
                <a href="https://xichenlab.com/BIO210-BioStats/course/"><span data-feather='list'></span> Content Index </a>
            </div>
            
            <div class="nav-link">
                <a href="https://xichenlab.com/BIO210-BioStats/about/"><span data-feather='file-text'></span> About </a>
            </div>
            
            <div class="nav-link">
                <a href="https://github.com/SUSTech-ChenLab/BIO210-BioStats"><span data-feather='github'></span>  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <span id="dark-theme-toggle-screen-reader-target" class="sr-only"></span>
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <span id="hamburger-menu-toggle-screen-reader-target" class="sr-only">menu</span>
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="https://xichenlab.com/BIO210-BioStats"><span data-feather='home'></span> Home </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://xichenlab.com/BIO210-BioStats/course/"><span data-feather='list'></span> Content Index </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://xichenlab.com/BIO210-BioStats/about/"><span data-feather='file-text'></span> About </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://github.com/SUSTech-ChenLab/BIO210-BioStats"><span data-feather='github'></span>  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <span id="dark-theme-toggle-screen-reader-target" class="sr-only">theme</span>
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">
    <div class="post-header-section">
        <h1>Lecture 20 Confidence Interval For The Variance</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">
            April 7, 2024
        </p>

        <ul class="post-tags">
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <p>Once we have introduced the confidence intervals for the population mean $\mu$, the next question comes natural: how do we construct confidence intervals for the population variance $\sigma^2$? Since we have previously discussed the sampling distribution of the sample variance, it is kind of straightforward for us to derive the confidence interval for the population variance.</p>
<h2 id="interval-estimation-for-boldsymbolsigma2">Interval Estimation For $\boldsymbol{\sigma^2}$</h2>
<p>We can just follow the same thought from the previous lecture when we derived the CI for the population mean $\mu$. Let&rsquo;s start with what we know about the variance. If you recall, we know that:</p>
<p>$$\cfrac{(n-1)S^2}{\sigma^2} \sim \chi^2(n-1)$$</p>
<p>Since the $\chi^2$-distribution has a well defined PDF, we could use it to help us to calculate probabilities. If we want a two-sided 95% CI for $\sigma$, we often would like a &ldquo;symmetrical&rdquo; one. We can put the following picture in our head to help us visualise in the same way when we construct the CI for the mean:</p>
<figure><img src="https://xichenlab.com/BIO210-BioStats/images/post_figures/95CI_var.png" width="350px">
</figure>

<p>The probability of a $\chi^2$ random variable with a degree of freedom $\nu$ falling into the middle white area is $95\%$. Therefore, we start from there (note all of them are positive numbers):</p>
<p>$$
\begin{aligned}
\mathbb{P} \left( \chi^2_{0.975,n-1} \leqslant \chi^2 \leqslant \chi^2_{0.025,n-1} \right) &amp;= 0.95\\[10pt]
\mathbb{P} \left[ \chi^2_{0.975,n-1} \leqslant \cfrac{(n-1)S^2}{\sigma^2} \leqslant \chi^2_{0.025,n-1} \right] &amp;= 0.95\\[10pt]
\mathbb{P} \left[ \cfrac{1}{\chi^2_{0.025,n-1}} \leqslant \cfrac{\sigma^2}{(n-1)S^2} \leqslant \cfrac{1}{\chi^2_{0.975,n-1}} \right] &amp;= 0.95\\[12.5pt]
\mathbb{P} \left[ \cfrac{(n-1)S^2}{\chi^2_{0.025,n-1}} \leqslant \sigma^2 \leqslant \cfrac{(n-1)S^2}{\chi^2_{0.975,n-1}} \right] &amp;= 0.95
\end{aligned}
$$</p>
<p>Now we have get our 95% CI for the population variance $\sigma^2$:</p>
<p>$$\left[ \cfrac{(n-1)S^2}{\chi^2_{0.025,n-1}}, \cfrac{(n-1)S^2}{\chi^2_{0.975,n-1}} \right]$$</p>
<p>Whenever we have a sample, the values of $S$ and $n$ are determined. We could put the numbers in to get the 95% CI.</p>
<h2 id="conditions-to-use-the-technique">Conditions To Use The Technique</h2>
<p>Now we summarise below the confidence intervals we have constructed so far. The two-sided confidence intervals with $(1-\alpha) \times 100\%$ confidence level are:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: center">$\boldsymbol{\mu}$ with known $\boldsymbol{\sigma}$</th>
          <th style="text-align: center">$\boldsymbol{\mu}$ with unknown $\boldsymbol{\sigma}$</th>
          <th style="text-align: center">$\boldsymbol{\sigma^2}$</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">$\bar{X} \pm Z_{\frac{\alpha}{2}} \cdot \frac{\sigma}{\sqrt{n}}$</td>
          <td style="text-align: center">$\bar{X} \pm t_{\frac{\alpha}{2},n-1} \cdot \frac{S}{\sqrt{n}}$</td>
          <td style="text-align: center">$\left[ \cfrac{(n-1)S^2}{\chi^2_{\frac{\alpha}{2},n-1}}, \cfrac{(n-1)S^2}{\chi^2_{1-\frac{\alpha}{2},n-1}} \right]$</td>
      </tr>
  </tbody>
</table>
<p>One thing we need to remember is that when we construct those CIs, there are some assumptions. Therefore, there are conditions for us when we use the above formulae. Let&rsquo;s look at them explicitly.</p>
<p>First of all, we need the sample $X_1,X_2,\cdots,X_{n-1},X_n$ to be <strong>i.i.d.</strong>. Therefore, the sample must be <strong>randomly and independently</strong> selected from the population. If this is not the case, the sample is not a good representation of the population, so the conclusion will not be useful. This condition must be met for all statistical inferences besides confidence intervals.</p>
<p>Now let&rsquo;s look at those CIs one by one. The reason we use $\bar{X} \pm Z_{\frac{\alpha}{2}} \cdot \frac{\sigma}{\sqrt{n}}$ is predicated on the assumption that</p>
<p>$$\cfrac{\bar{X} - \mu}{\sigma/\sqrt{n}} \sim \mathcal{N}(0,1)$$</p>
<p>When is that true? It is true when $\bar{X}$ follows a normal distribution. When does $\bar{X}$ follow a normal distribution? When <strong>the population is normally distributed</strong> or <strong>the sample size is large enough</strong>.</p>
<p>Further, the reason we use $\bar{X} \pm t_{\frac{\alpha}{2},n-1} \cdot \frac{S}{\sqrt{n}}$ is predicated on the assumption that</p>
<p>$$\cfrac{\bar{X} - \mu}{S/\sqrt{n}} = \cfrac{\frac{\bar{X}-\mu}{\sigma/\sqrt{n}}}{\sqrt{\frac{(n-1)S^2}{\sigma^2} \cdot \frac{1}{n-1}}} \sim \boldsymbol{\mathcal{T}}(n-1)$$</p>
<p>When is that true? When the numerator $\frac{\bar{X} - \mu}{\sigma/\sqrt{n}}$ follows a standard normal distribution <em><strong>AND</strong></em> the term $\frac{(n-1)S^2}{\sigma^2}$ in the denominator follows a $\chi^2(n-1)$ distribution. When are those true? We already talked about the numerator. For $\frac{(n-1)S^2}{\sigma^2}$ to follow a $\chi^2(n-1)$ distribution, we need <strong>the population to be normally distributed</strong>.</p>
<p>Similarly, the reason we use $\left[ \cfrac{(n-1)S^2}{\chi^2_{\frac{\alpha}{2},n-1}}, \cfrac{(n-1)S^2}{\chi^2_{1-\frac{\alpha}{2},n-1}} \right]$ is predicated on the assumption that</p>
<p>$$\cfrac{(n-1)S^2}{\sigma^2} \sim \chi^2(n-1)$$</p>
<p>That is true when <strong>the population to be normally distributed</strong>.</p>
<p>As you can see, in order to use the formulae in the table to construct CIs, we need the following assumptions to be true:</p>
<ol>
<li>The samples are <strong>randomly and independently</strong> selected from the population</li>
<li><strong>The normality condition</strong>: The population is normally distributed.</li>
<li>When $\sigma$ is known, and we want a CI for the mean $\mu$, as long as the sample size is large enough, it is still okay even if the population is not normally distributed.</li>
</ol>
<p>The point I want to make here is to showcase that those assumptions all come natural if you truly understand the principles.</p>
<h2 id="violation-of-the-normality-assumption">Violation of The Normality Assumption</h2>
<p>We can use some simulations to see what happens when we draw sample from a non-normal distribution. I use some <code>python</code> code for the demonstration, and just use the distribution of the sample variance as an example. You can try others by yourself.</p>
<p>Let&rsquo;s start with a heavily skewed distribution, such as an <strong>exponential distribution</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># import some helper functions from common libraries</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> norm, chi2, poisson, expon
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create an exponential population with a rate parameter 1</span>
</span></span><span style="display:flex;"><span>pop_expo <span style="color:#f92672">=</span> expon(scale <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>pop_var <span style="color:#f92672">=</span> pop_expo<span style="color:#f92672">.</span>var() <span style="color:#75715e"># population var is 1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># we can have a look at the shape of the population distribution</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># you can see it is heavily skewed to the right by uncommenting the next line</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># plt.plot(np.linspace(0,10,100), pop_expo.pdf(np.linspace(0,10,100)))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># now we draw a sample with size n=10</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># each time we draw a sample, we compute the score (chiscore) and record it</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># we repeat the process 10,000 times</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># so we have 10,000 chiscore</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>          <span style="color:#75715e"># sample size</span>
</span></span><span style="display:flex;"><span>chiscores <span style="color:#f92672">=</span> []  <span style="color:#75715e"># place holder for chiscore in each sample</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10000</span>):
</span></span><span style="display:flex;"><span>    sample <span style="color:#f92672">=</span> pop_expo<span style="color:#f92672">.</span>rvs(size <span style="color:#f92672">=</span> n)       <span style="color:#75715e"># draw a sample with size n</span>
</span></span><span style="display:flex;"><span>    s2 <span style="color:#f92672">=</span> sample<span style="color:#f92672">.</span>var(ddof <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)          <span style="color:#75715e"># compute the sample variance</span>
</span></span><span style="display:flex;"><span>    chiscore <span style="color:#f92672">=</span> (n <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> s2 <span style="color:#f92672">/</span> pop_var  <span style="color:#75715e"># compute the chiscore</span>
</span></span><span style="display:flex;"><span>    chiscores<span style="color:#f92672">.</span>append(chiscore)         <span style="color:#75715e"># record the chiscore</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># now we can compare the distribution of chiscores with</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># a theoretical chi-squared distribution with n-1 DOF</span>
</span></span><span style="display:flex;"><span>rv <span style="color:#f92672">=</span> chi2(n<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)   <span style="color:#75715e"># create a chi-squared random variable with n-1 DOF</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">### look at the histogram of the chiscores from the simulation in red colour</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hist(chiscores, bins <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>, density <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;r&#39;</span>, ec<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;k&#39;</span>) 
</span></span><span style="display:flex;"><span><span style="color:#75715e">### look at the theoretical density function of a chi-squared rv with n-1 DOF in blue colour</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, n<span style="color:#f92672">*</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">100</span>), rv<span style="color:#f92672">.</span>pdf(np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, n<span style="color:#f92672">*</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">100</span>)), <span style="color:#e6db74">&#39;b-&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p>You can manipulate the above code to check different sample size. I have tried $n=10,50,100$. The results are shown below:</p>
<p><img src="https://xichenlab.com/BIO210-BioStats/images/post_figures/expon_pop_chi_simulation.png" alt=""></p>
<p>As you can see, they do not really fit even with large sample sizes.</p>
<p>We can also manipulate the above code to see what happens from a different kind of population. Say, we draw samples from a Poisson population with a mean $\lambda = 4$. This is achieved by:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pop_pois <span style="color:#f92672">=</span> poisson(<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>pop_var <span style="color:#f92672">=</span> pop_pois<span style="color:#f92672">.</span>var() <span style="color:#75715e"># population variance is 4</span>
</span></span></code></pre></div><p>The simulation results are:</p>
<p><img src="https://xichenlab.com/BIO210-BioStats/images/post_figures/pois_pop_chi_simulation.png" alt=""></p>
<p>In this case, it is not bad at all, even $Pois(4)$ is not normal. Notice that $Pois(4)$ is roughly symmetrical around its mean. Even though the population is still skewed to the right, but the data after $x &gt; 10$ is negligible.</p>
<p>Therefore, in practice, it is not the end of the world when the &ldquo;normality&rdquo; condition is violated, especially when the population is roughly symmetrical.</p>


<div class="admonition tip">
    <div class="title">References</div>
    <div class="content"><ul>
<li><a href="http://en.wikipedia.org/wiki/Chi-squared_distribution">Chi-squared Distribution</a></li>
<li><a href="https://stats.stackexchange.com/questions/9573/t-test-for-non-normal-when-n50">T-test for non normal when sample size is large</a></li>
<li><a href="https://link.springer.com/article/10.3758/s13428-021-01587-5">Violating the normality assumption may be the lesser of two evils</a></li>
</ul>
</div>
</div>

        </p>
    </div>

    <div class="prev-next">
        
    </div>
</div>

<aside class="post-toc">
    <nav id="toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#interval-estimation-for-boldsymbolsigma2">Interval Estimation For $\boldsymbol{\sigma^2}$</a></li>
    <li><a href="#conditions-to-use-the-technique">Conditions To Use The Technique</a></li>
    <li><a href="#violation-of-the-normality-assumption">Violation of The Normality Assumption</a></li>
  </ul>
</nav>
    </nav>
</aside>



    

        </main><footer class="footer">
    <span>&copy; 2025 SUSTech BIO210 Biostatistics</span>
    <span>
        Made with &#10084;&#65039; using <a target="_blank" href="https://github.com/526avijitgupta/gokarna">Gokarna</a>
    </span>
</footer>
</body>
</html>
